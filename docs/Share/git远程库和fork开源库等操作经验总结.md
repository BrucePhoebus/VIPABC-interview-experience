---
title: git远程库和fork开源库等操作经验总结
date: 2021-08-07 23:46:00
author: zhengyekun
updated: 2021-08-10 00:26:17
tags: 
  - 分享
  - git经验
---
# git远程库和fork开源库等操作经验总结

git管理是现在程序员必须会的一项技能了，常见我们会用到分支管理和合并冲突之类的，这些都是比较常见项目中用到的操作，而远程库和开源贡献这些词更是我们想要认识和参与的事业，对git这个工具的进一步认识，应该不断进行。工欲行其事必先利其器

## 关于远程库和fork开源开发模式的理解

我们经常`git remote add origin git:xxx`这样去添加远程库，这是git开发的一个常见操作和基础

这个实际上为本地添加远程库，而我们commit提交的就是本地库，也就是我们常见于origin远程库和本地库这两种库，实际上就是一个在线上，一个在本地，git通过版本比较进行管理，而这样也就允许了多人提交，只是比较版本库和一些提交信息而已

但是当我们遇到开源开发的时候，会有这么一个操作`git remote add upstream https:xxx`添加开源库的地址，实际上我们会fork开源库，或有些项目不进行分支开发而是使用这样fork开源模式开发，我们fork形成自己的远程库，然后pull到自己本地形成本地库

这样我们脑袋中就形成一个根源散列出去的线图，就是一个个开源库作为根，然后下一个节点是每个人远程库，在下一个节点是每个人本地库。好像三者是有关联的，实际上就是放在三个机器上的三个git库，git不管你是不是远程还是本地，都是进行版本比较，pull是以本地作为主库添加其他版本的信息，而push则是远程库作为主库添加其他版本，一个commit就是一个版本

#### 私有远程库和开源库

那么私有远程库和开源库有什么关系呢？实际上没有关系，对于我们本地，他们都是远程库，至于叫什么名字，origin还是upstream，只是这个名字而已，都是远程库，实际上就是一个git库，我们从一个git库(本地)推送到另一个git库(私有远程库或开源库)，然后作为主库的远程库就版本比较进行合并，只是开源模式我们经常没有权限，只能是一个PR的提交，这个工具也是支持的，如果有权限的话，实际上我们可以直接git push到开源库，可以直接提交合并的，而开源模式通过PR则多了一层代码审核，所以很多公司内部代码审核也是这种模式

也就是从git的角度本地库`.git`和私有远程库、开源库没什么差别，而且去操作一下我们可以添加无数的远程库，远程库1、2、3、4，代表层层的fork，当然我们一般都是单线操作，也就是我们本地开发完push到私有远程库，然后私有远程库PR提交上游fork的源库，而我们的上游也说不定还有上游

upstream代表的就是上游的意思，也就是我们可以直接推送代码给上游源库，而不需要通过远程库去提交PR，因为对于上游来说我们本地还是私有远程库是一样的，我们本地也有工具化的可操作平台

本来我想说有个PR功能有个背后的git指令，但是实际上是没有的，PR是平台的功能，也就是GitHub和Gitee这些平台的支持的功能，而git是没有这个概念，如此我们只能手动操作了

> PR(Pull Request)是我们对上游的一个修改的提交，实际上跟开发一样的道理，就是版本提交，让别人来合并我们的提交，这也是工具需要支持的功能，等待审查合并处理

```BASH
# 同步上游代码
git pull upstream master
# 推送本地最新到上游，如果没有add upstream的话要后面加上上游地址
git remote add upstream
```

但是这样的提交是upstream上游我们需要有权限，没有权限是提交不了的，这不是PR的意思，依旧是提交远程库的含义，没有权限提交失败

对于PR，我们只能提交到私有远程库，或再本地弄个平台进行工具提交上游，fork的时候会有记录上游，可任意这样执行

#### fork开源模式

实际上fork出来的开发模式叫不叫开源模式也不知道，或许叫代码审查模式，因为我们push到私有库之后需要PR提交源库，源库会有人进行审查合并

针对某个分支提交PR，所以我们如果只是对一个功能的change，我们往往可以选择开辟一个新的分支针对这个问题做出修改，然后提交这个分支作为PR的change内容，避免除了这些我们想要改的功能的内容外还有别的内容，例如改了一些细节的描述注释之类的，这些在开源模式的时候未必要提交，最好的办法就是分支关联，New PR的时候我们可以选择分支提交，也是如此

实际上最终依旧是版本库的比较，`compare`的内容，作为开源管理者会在PR合并的时候看到修改的内容，并创建分支合并测试，如果测试通过则合并到dev或某些分支处理

而作为开源贡献者或开源模式的开发者，每次需要注意提交的功能与描述内容的匹配，当然内部使用这种作为代码审查模式开发时，我们未必严格按照功能描述提交，可能很多描述之外的功能，但是开源贡献的时候是不应该有这样的，每一个点的修改都应该被描述到
